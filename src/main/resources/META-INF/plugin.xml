<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.cquilez.pitesthelper</id>
    <name>PITest Helper</name>
    <vendor>Carmelo Qu√≠lez</vendor>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends optional="true" config-file="kotlin-plugin.xml">org.jetbrains.kotlin</depends>
    <depends optional="true" config-file="maven-plugin.xml">org.jetbrains.idea.maven</depends>
    <depends optional="true" config-file="gradle-plugin.xml">org.jetbrains.plugins.gradle</depends>

    <resource-bundle>messages.app</resource-bundle>

    <!-- Add Kotlin plugin K2 mode compatibility -->
    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <dependencySupport coordinate="org.pitest:pitest-maven" kind="java" displayName="PITest"/>
        <dependencySupport coordinate="info.solidsoft.pitest:gradle-pitest-plugin" kind="java" displayName="PITest"/>
        <!-- Use cases -->
        <projectService
                serviceInterface="com.cquilez.pitesthelper.application.port.in.RunMutationCoverageFromProjectViewPort"
                serviceImplementation="com.cquilez.pitesthelper.application.usecase.RunMutationCoverageFromProjectViewUseCase"/>

        <!-- Adapters -->
        <applicationService
                serviceInterface="com.cquilez.pitesthelper.infrastructure.ui.NavigatablePort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.ui.adapter.NavigatableAdapter"/>
        <applicationService
                serviceInterface="com.cquilez.pitesthelper.infrastructure.extension.PsiPort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.adapter.psi.JavaPsiAdapter"/>
        <projectService
                serviceInterface="com.cquilez.pitesthelper.application.port.out.BuildUnitPort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.adapter.buildunit.BuildUnitAdapter"/>
        <projectService
                serviceInterface="com.cquilez.pitesthelper.application.port.out.CodeElementPort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.adapter.codeelement.CodeElementAdapter"/>
        <projectService
                serviceInterface="com.cquilez.pitesthelper.application.port.out.SourceFolderPort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.adapter.sourcefolder.SourceFolderAdapter"/>
        <projectService
                serviceInterface="com.cquilez.pitesthelper.application.port.out.UserInterfacePort"
                serviceImplementation="com.cquilez.pitesthelper.infrastructure.ui.adapter.UserInterfaceAdapter"/>
    </extensions>

    <actions>
        <action
                id="com.cquilez.pitesthelper.action.RunMutationCoverageFromProjectView"
                class="com.cquilez.pitesthelper.infrastructure.action.RunMutationCoverageFromProjectViewAction"
                icon="/icons/bird.svg">
            <override-text place="ProjectViewPopup"/>
            <add-to-group group-id="ProjectViewPopupMenuModifyGroup"
                          relative-to-action="com.cquilez.pitesthelper.action.RunMutationCoverageFromProjectView" anchor="after"/>
        </action>
    </actions>
    <extensionPoints>
        <extensionPoint
                name="buildSystemPort"
                interface="com.cquilez.pitesthelper.application.port.out.BuildSystemPort"
                dynamic="true"/>
        <extensionPoint
                name="buildUnitServicePort"
                interface="com.cquilez.pitesthelper.application.port.out.BuildUnitServicePort"
                dynamic="true"/>
    </extensionPoints>

    <extensions defaultExtensionNs="com.cquilez.pitesthelper">
        <buildSystemPort
                implementation="com.cquilez.pitesthelper.infrastructure.adapter.buildsystem.GradleBuildSystemAdapter"/>
        <buildUnitServicePort
                implementation="com.cquilez.pitesthelper.infrastructure.service.buildunit.MavenBuildUnitService"/>
        <buildUnitServicePort
                implementation="com.cquilez.pitesthelper.infrastructure.service.buildunit.GradleBuildUnitService"/>
    </extensions>
</idea-plugin>
